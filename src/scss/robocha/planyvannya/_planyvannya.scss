// --- ЗМІННІ ---
$primary-blue: #004d26;
$light-gray: #f5f5f5;
$border-gray: #ddd;
$border-dark: #bbb;
$text-dark: #333;
$white: #fff;

// Розміри
$header-height: 45px;
$row-height: 70px;
$sidebar-width: 220px;

// --- БАЗОВІ СТИЛІ ---
.post-planning-container {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif;
  font-size: 14px;
  color: $text-dark;
  background: $light-gray;
  display: flex;
  flex-direction: column;
  height: 100vh;
  margin: 0; padding: 0;
  overflow: hidden;
  * { margin: 0; padding: 0; box-sizing: border-box; }
}

// --- HEADER ---
.post-header {
  display: flex; align-items: center; padding: 0 24px; background: $primary-blue; color: $white; height: 50px; flex-shrink: 0; z-index: 200;
  .post-nav {
    display: flex; gap: 16px; align-items: center; width: 100%;
    .post-nav-link { padding: 8px 16px; color: $white; text-decoration: none; border-radius: 4px; font-weight: 500; &:hover { background: rgba(255, 255, 255, 0.1); } &.post-active { background: rgba(255, 255, 255, 0.2); }}
    .post-header-calendar-nav { display: flex; align-items: center; gap: 12px; margin-left: auto; 
      .post-today-btn { padding: 6px 12px; background: rgba(255, 255, 255, 0.15); border: 1px solid rgba(255,255,255,0.3); border-radius: 4px; color: $white; cursor: pointer; &:hover { background: rgba(255, 255, 255, 0.25); }}
      .post-nav-arrow { background: transparent; border: none; color: $white; font-size: 24px; cursor: pointer; &:hover { transform: scale(1.2); }}
      .post-current-date { font-weight: 600; min-width: 150px; text-align: center; }
    }
  }
}

// --- MAIN CONTENT ---
.post-main-content {
  display: flex; flex: 1; overflow: hidden; height: calc(100vh - 50px);
}

// 1. ГОЛОВНИЙ WRAPPER
.post-scheduler-wrapper {
  flex: 1; display: flex; flex-direction: column; overflow-y: auto; background: $white; position: relative; border-right: 1px solid $border-gray;
  &::-webkit-scrollbar { width: 10px; height: 10px; }
  &::-webkit-scrollbar-track { background: $light-gray; }
  &::-webkit-scrollbar-thumb { background: #ccc; border-radius: 5px; border: 2px solid $light-gray; }
}

// 2. STICKY HEADER
.post-sticky-header {
  position: sticky; top: 0; z-index: 100; background: $white; display: flex; border-bottom: 1px solid $border-dark; min-height: $header-height;
  
  .post-header-corner {
    width: $sidebar-width; min-width: $sidebar-width; background: #f8f9fa; border-right: 1px solid $border-gray;
    display: flex; align-items: center; justify-content: center; font-weight: 700; color: #888; font-size: 11px; text-transform: uppercase;
  }

  .post-time-header {
    flex: 1; display: grid; grid-template-columns: repeat(24, 1fr); position: relative; background: #fff;

    // СІРА ЗАЛИВКА + ЧЕРВОНА ЛІНІЯ (ШАПКА)
    &::after {
        content: ''; position: absolute; top: 0; bottom: 0; left: 0;
        width: calc(var(--past-percentage, 0) * 100%);
        background: rgba(0, 0, 0, 0.05); 
        border-right: 2px solid #ff0000;
        pointer-events: none; z-index: 2;
    }

    .post-time-cell {
      display: flex; position: relative; height: 100%;
      padding-left: 6px; 
      &.hour-cell { background: $white; color: $text-dark; font-size: 15px; font-weight: 400; align-items: center; justify-content: flex-start; border-right: 1px dashed #eee; }
      &.min-cell { background: #fafafa; color: #999; font-size: 11px; font-weight: 400; align-items: flex-start; padding-top: 4px; justify-content: flex-start; border-right: 1px solid $border-dark; }
      &:last-child { border-right: none; }
    }
  }
}

// 3. ТІЛО ТАБЛИЦІ
.post-scheduler-body {
  position: relative; min-height: 100%;
  background-size: calc((100% - #{$sidebar-width}) / 24) 100%; 
  background-image: linear-gradient(to right, $border-gray 1px, transparent 1px);
  background-position-x: $sidebar-width; background-repeat: repeat-x;

  // СІРА ЗАЛИВКА + ЧЕРВОНА ЛІНІЯ (ТІЛО)
  &::after {
    content: ''; position: absolute; top: 0; bottom: 0; 
    left: $sidebar-width; 
    width: calc(var(--past-percentage, 0) * (100% - #{$sidebar-width})); 
    background: rgba(0, 0, 0, 0.05); 
    border-right: 2px solid #ff0000; 
    pointer-events: none; z-index: 10;
  }
}

.post-section-header {
  position: sticky; top: $header-height; z-index: 90; background: #e9ecef; color: #495057; padding: 0 16px; font-weight: 700; font-size: 13px;
  border-bottom: 1px solid $border-gray; border-top: 1px solid $border-gray; display: flex; justify-content: space-between; align-items: center; cursor: pointer; height: 32px;
  .post-toggle-btn { background: none; border: none; font-size: 10px; cursor: pointer; color: inherit; transition: transform 0.2s; }
}
.post-section-content.hidden { display: none; }

.post-unified-row {
  display: flex; height: $row-height; border-bottom: 1px solid $border-gray; background: transparent; position: relative;
  &:hover { background: rgba(0, 0, 0, 0.015); .post-row-label { background: #f1f3f5; color: $primary-blue; }}

  .post-row-label {
    width: $sidebar-width; min-width: $sidebar-width; border-right: 3px solid $primary-blue; padding: 8px 16px;
    display: flex; flex-direction: column; justify-content: center; background: #f8f9fa; z-index: 20; 
    .post-post-title { font-weight: 700; font-size: 14px; margin-bottom: 4px; color: $text-dark; }
    .post-post-subtitle { font-size: 12px; color: #888; }
  }

  .post-row-track {
    flex: 1; display: grid; grid-template-columns: repeat(24, 1fr); position: relative; padding: 6px 0;
    
    .post-appointment {
      margin: 0 4px; padding: 6px 10px; border-radius: 4px; font-size: 12px; cursor: pointer; 
      z-index: 30; overflow: hidden; white-space: nowrap; box-shadow: 0 2px 4px rgba(0,0,0,0.1); display: flex; flex-direction: column; justify-content: center; border-left-width: 4px; border-left-style: solid; transition: all 0.2s;
      &:hover { transform: translateY(-2px); box-shadow: 0 6px 12px rgba(0, 0, 0, 0.15); z-index: 40; }
      
      &.post-pink { background: #ffe3e3; border-left-color: #fa5252; color: #491212; }
      &.post-green { background: #d3f9d8; border-left-color: #40c057; color: #0b2e13; }
      &.post-beige { background: #fff3bf; border-left-color: #fab005; color: #5f370e; }
      .post-car-model { font-weight: 700; margin-bottom: 2px; font-size: 12px; }
      .post-car-number { font-size: 11px; font-family: monospace; background: rgba(255,255,255,0.4); display: inline-block; padding: 1px 4px; border-radius: 3px; width: fit-content;}
    }
  }
}

.post-add-reminder-btn { padding: 10px; margin: 10px; width: calc(100% - 20px); background: $white; border: 2px dashed $border-gray; border-radius: 6px; color: #888; cursor: pointer; &:hover { border-color: $primary-blue; color: $primary-blue; }}

// 5. ПРАВА КОЛОНКА (Міні календар)
.post-mini-calendar {
  width: 300px; background: $white; border-left: 1px solid $border-gray; padding: 24px; overflow-y: auto; z-index: 150; display: flex; flex-direction: column;
  
  .post-year-nav { display: flex; justify-content: space-between; margin-bottom: 20px; button { background: none; border: none; font-size: 20px; cursor: pointer; } span { font-weight: 700; }}
  
  // ВАЖЛИВО: Стиль для контейнера календаря
  #postCalendarContainer {
     width: 100%;
     min-height: 250px; // Щоб він мав висоту навіть якщо порожній
     flex-grow: 1;
  }

  .post-month-calendar { margin-bottom: 30px; 
    h3 { font-size: 14px; margin-bottom: 15px; text-align: center; text-transform: uppercase; letter-spacing: 1px; color: $primary-blue; }
    .post-weekdays { display: grid; grid-template-columns: repeat(7, 1fr); text-align: center; font-weight: 700; color: #adb5bd; margin-bottom: 5px;} 
    .post-days { display: grid; grid-template-columns: repeat(7, 1fr); gap: 4px; 
      span { aspect-ratio: 1; display: flex; align-items: center; justify-content: center; border-radius: 50%; cursor: pointer; 
        &.post-today { border: 2px solid $primary-blue; color: $primary-blue; font-weight: 700; } 
        &.post-selected-date { background: $primary-blue; color: $white; }
      }
    }
  }

  .post-legend { margin-top: auto; padding-top: 20px; border-top: 1px solid $border-gray; display: flex; flex-direction: column; gap: 10px; 
    .post-legend-item { display: flex; gap: 10px; align-items: center;
      .post-color-box { width: 14px; height: 14px; border-radius: 3px; &.post-scheduled { background: #ffefb3; } &.post-no-show { background: #ffb3b3; } &.post-in-progress { background: #b3e6cc; } &.post-repaired { background: #e6e6e6; }}
    }
  }
}