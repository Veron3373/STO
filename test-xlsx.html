<!DOCTYPE html>
<html lang="uk">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–¢–µ—Å—Ç XLSX</title>

    <!-- –ó–∞–≤–∞–Ω—Ç–∞–∂—É—î–º–æ XLSX –∑ CDN -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>

    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
            max-width: 600px;
            margin: 0 auto;
        }

        button {
            padding: 10px 20px;
            font-size: 16px;
            cursor: pointer;
            background: #4CAF50;
            color: white;
            border: none;
            border-radius: 4px;
            margin: 10px 0;
        }

        button:hover {
            background: #45a049;
        }

        #status {
            margin: 20px 0;
            padding: 10px;
            border-radius: 4px;
            background: #f0f0f0;
        }

        .success {
            background: #d4edda !important;
            color: #155724;
        }

        .error {
            background: #f8d7da !important;
            color: #721c24;
        }
    </style>
</head>

<body>
    <h1>üß™ –¢–µ—Å—Ç –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è XLSX</h1>

    <div id="status">–û—á—ñ–∫—É–≤–∞–Ω–Ω—è...</div>

    <button onclick="testXLSX()">üì• –¢–µ—Å—Ç—É–≤–∞—Ç–∏ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è Excel</button>

    <script>
        // –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –ø—Ä–∏ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—ñ
        window.addEventListener('load', function () {
            const statusDiv = document.getElementById('status');

            if (typeof XLSX !== 'undefined') {
                statusDiv.className = 'success';
                statusDiv.innerHTML = '‚úÖ –ë—ñ–±–ª—ñ–æ—Ç–µ–∫–∞ XLSX –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–∞ —É—Å–ø—ñ—à–Ω–æ!<br>–í–µ—Ä—Å—ñ—è: ' + (XLSX.version || '–Ω–µ–≤—ñ–¥–æ–º–∞');
                console.log('‚úÖ XLSX –¥–æ—Å—Ç—É–ø–Ω–∞:', XLSX);
            } else {
                statusDiv.className = 'error';
                statusDiv.innerHTML = '‚ùå –ë—ñ–±–ª—ñ–æ—Ç–µ–∫–∞ XLSX –ù–ï –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–∞!';
                console.error('‚ùå XLSX –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞');
            }
        });

        // –¢–µ—Å—Ç–æ–≤–∞ —Ñ—É–Ω–∫—Ü—ñ—è
        function testXLSX() {
            const statusDiv = document.getElementById('status');

            try {
                if (typeof XLSX === 'undefined') {
                    throw new Error('XLSX –Ω–µ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–∞');
                }

                // –°—Ç–≤–æ—Ä—é—î–º–æ —Ç–µ—Å—Ç–æ–≤—ñ –¥–∞–Ω—ñ
                const testData = [
                    { "–Ü–º'—è": "–Ü–≤–∞–Ω", "–ü—Ä—ñ–∑–≤–∏—â–µ": "–ü–µ—Ç—Ä–µ–Ω–∫–æ", "–í—ñ–∫": 30 },
                    { "–Ü–º'—è": "–ú–∞—Ä—ñ—è", "–ü—Ä—ñ–∑–≤–∏—â–µ": "–ö–æ–≤–∞–ª–µ–Ω–∫–æ", "–í—ñ–∫": 25 },
                    { "–Ü–º'—è": "–û–ª–µ–≥", "–ü—Ä—ñ–∑–≤–∏—â–µ": "–°–∏–¥–æ—Ä–µ–Ω–∫–æ", "–í—ñ–∫": 35 }
                ];

                // –°—Ç–≤–æ—Ä—é—î–º–æ worksheet
                const worksheet = XLSX.utils.json_to_sheet(testData);

                // –°—Ç–≤–æ—Ä—é—î–º–æ workbook
                const workbook = XLSX.utils.book_new();
                XLSX.utils.book_append_sheet(workbook, worksheet, "–¢–µ—Å—Ç");

                // –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è —à–∏—Ä–∏–Ω–∏ –∫–æ–ª–æ–Ω–æ–∫
                worksheet['!cols'] = [
                    { wch: 15 },
                    { wch: 15 },
                    { wch: 10 }
                ];

                // –ó–∞–≤–∞–Ω—Ç–∞–∂—É—î–º–æ —Ñ–∞–π–ª
                const fileName = '–¢–µ—Å—Ç_' + new Date().getTime() + '.xlsx';
                XLSX.writeFile(workbook, fileName);

                statusDiv.className = 'success';
                statusDiv.innerHTML = '‚úÖ Excel —Ñ–∞–π–ª —É—Å–ø—ñ—à–Ω–æ —Å—Ç–≤–æ—Ä–µ–Ω–æ —ñ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–æ!<br>–§–∞–π–ª: ' + fileName;
                console.log('‚úÖ –§–∞–π–ª —Å—Ç–≤–æ—Ä–µ–Ω–æ:', fileName);

            } catch (error) {
                statusDiv.className = 'error';
                statusDiv.innerHTML = '‚ùå –ü–æ–º–∏–ª–∫–∞: ' + error.message;
                console.error('‚ùå –ü–æ–º–∏–ª–∫–∞:', error);
            }
        }
    </script>
</body>

</html>