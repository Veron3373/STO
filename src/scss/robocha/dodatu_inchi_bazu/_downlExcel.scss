// downlExcel.scss - –°—Ç–∏–ª—ñ –¥–ª—è batch-—ñ–º–ø–æ—Ä—Ç—É –∑ Excel
@use "sass:color";
// ============= –ó–º—ñ–Ω–Ω—ñ =============
$primary-blue: #2196f3;
$primary-green: #4caf50;
$primary-yellow: #ffc107;
$danger-red: #f44336;
$neutral-gray: #6c757d;
$warning-orange: #ff9800;
$text-dark: #333;
$text-light: #666;
$text-placeholder: #999;
$border-color: #ddd;
$border-strong: #999;
$border-cell: #c0c0c0;
$bg-light: #f8f9fa;
$bg-header: #e9ecef;
$bg-input: #fafafa;
$bg-warning: #fff3e0;
$bg-error: #ffebee;
$shadow-hover: 0 4px 12px rgba(0, 0, 0, 0.15);
$shadow-modal: 0 10px 40px rgba(0, 0, 0, 0.2);
$shadow-confirm: 0 10px 40px rgba(0, 0, 0, 0.3);
$shadow-dropdown: 0 8px 24px rgba(33, 150, 243, 0.25),
  0 4px 8px rgba(0, 0, 0, 0.1);
$transition: all 0.3s ease;
$transition-fast: all 0.2s ease;
$radius-small: 4px;
$radius-medium: 8px;
$radius-large: 12px;
$radius-xlarge: 16px;

// ============= –ú—ñ–∫—Å–∏–Ω–∏ =============
@mixin gradient-button($color, $hover: false) {
  $lightness-start: if($hover, -5%, 0%);
  $lightness-end: if($hover, -15%, -10%);

  background: linear-gradient(135deg,
      color.adjust($color, $lightness: $lightness-start) 0%,
      color.adjust($color, $lightness: $lightness-end) 100%);
}

@mixin button-base {
  border: none;
  border-radius: $radius-medium;
  cursor: pointer;
  font-weight: 600;
  transition: $transition;
  text-transform: uppercase;
  letter-spacing: 0.5px;

  &:hover {
    transform: translateY(-2px);
    box-shadow: $shadow-hover;
  }

  &:active {
    transform: translateY(0);
  }

  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
    transform: none;

    &:hover {
      box-shadow: none;
      transform: none;
    }
  }
}

@mixin scrollbar {
  &::-webkit-scrollbar {
    width: 12px;
    height: 12px;
  }

  &::-webkit-scrollbar-track {
    background: $bg-light;
    border-radius: $radius-small;
  }

  &::-webkit-scrollbar-thumb {
    background: #ccc;
    border-radius: $radius-small;
    border: 2px solid $bg-light;

    &:hover {
      background: #999;
    }
  }
}

// ============= –ú–æ–¥–∞–ª—å–Ω–∏–π –æ–≤–µ—Ä–ª–µ–π =============
.modal-overlay-all_other_bases {
  display: flex;
  align-items: center;
  justify-content: center;
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.5);
  z-index: 9999;
  backdrop-filter: blur(4px);

  &.hidden-all_other_bases {
    display: none;
  }
}

// ============= –ú–æ–¥–∞–ª—å–Ω–µ –≤—ñ–∫–Ω–æ –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–Ω—è =============
.confirm-modal-Excel {
  max-width: 480px;
  width: 90%;
  background: white;
  border-radius: $radius-xlarge;
  box-shadow: $shadow-confirm;
  overflow: hidden;
  animation: scaleIn 0.3s ease-out;
}

.confirm-content-Excel {
  padding: 32px;
  text-align: center;
}

.confirm-icon-Excel {
  font-size: 64px;
  margin-bottom: 20px;
  animation: bounce 0.6s ease-out;
}

.confirm-title-Excel {
  font-size: 22px;
  font-weight: 700;
  color: $text-dark;
  margin: 0 0 16px 0;
}

.confirm-message-Excel {
  font-size: 16px;
  color: $text-light;
  margin: 0 0 28px 0;
  line-height: 1.5;
}

.confirm-buttons-Excel {
  display: flex;
  gap: 12px;
  justify-content: center;
}

.confirm-btn-Excel {
  @include button-base;
  padding: 12px 32px;
  font-size: 15px;
  flex: 1;

  &.yes-Excel {
    @include gradient-button($primary-green);
    color: white;

    &:hover {
      @include gradient-button($primary-green, true);
    }
  }

  &.no-Excel {
    @include gradient-button($neutral-gray);
    color: white;

    &:hover {
      @include gradient-button($neutral-gray, true);
    }
  }
}

// ============= –ú–æ–¥–∞–ª—å–Ω–µ –≤—ñ–∫–Ω–æ —ñ–º–ø–æ—Ä—Ç—É =============
.batch-modal-Excel {
  max-width: 98vw;
  height: 85vh;
  min-width: 600px;
  width: 98vw;
  display: flex;
  flex-direction: column;
  background: white;
  border-radius: $radius-large;
  box-shadow: $shadow-modal;
  overflow: hidden;
  position: relative;
}

.modal-content-Excel {
  display: flex;
  flex-direction: column;
  height: 100%;
  width: 100%;
  padding: 24px;
  overflow: hidden;
}

.modal-close-all_other_bases {
  position: absolute;
  top: 12px;
  right: 12px;
  width: 36px;
  height: 36px;
  border: none;
  background: rgba(0, 0, 0, 0.1);
  border-radius: 50%;
  font-size: 24px;
  line-height: 1;
  cursor: pointer;
  transition: $transition-fast;
  color: $text-dark;
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 10;

  &:hover {
    background: rgba(0, 0, 0, 0.2);
    transform: rotate(90deg);
  }
}

.batch-title-Excel {
  font-size: 24px;
  margin: 0 0 16px 0;
  font-weight: 700;
  color: $text-dark;
  display: flex;
  align-items: center;
  gap: 12px;

  &::before {
    content: "üìä";
    font-size: 28px;
  }
}

.batch-instructions-Excel {
  font-size: 14px;
  margin-bottom: 16px;
  color: $text-light;
  line-height: 1.6;
  padding: 12px;
  background: color.adjust($primary-blue, $lightness: 45%);
  border-left: 4px solid $primary-blue;
  border-radius: $radius-small;

  strong {
    color: $text-dark;
    font-weight: 600;
  }

  code {
    background: rgba(0, 0, 0, 0.05);
    padding: 2px 6px;
    border-radius: 3px;
    font-family: "Consolas", "Monaco", monospace;
    font-size: 12px;
  }
}

.batch-textarea-Excel {
  width: 100%;
  min-height: 160px;
  max-height: 250px;
  padding: 14px;
  border: 2px solid $border-color;
  border-radius: $radius-medium;
  font-family: "Consolas", "Monaco", monospace;
  font-size: 13px;
  resize: vertical;
  transition: $transition;
  background: $bg-input;
  box-sizing: border-box;

  &:focus {
    outline: none;
    border-color: $primary-blue;
    background: white;
    box-shadow: 0 0 0 3px rgba($primary-blue, 0.1);
  }

  &::placeholder {
    color: $text-placeholder;
  }
}

// ============= –ö–Ω–æ–ø–∫–∏ =============
.batch-buttons-Excel {
  display: flex;
  gap: 16px;
  flex-shrink: 0;
  padding-top: 8px;
  margin-top: auto;
}

.batch-btn-Excel {
  @include button-base;
  flex: 1;
  padding: 10px 28px;
  font-size: 16px;
  position: relative;
  overflow: hidden;

  // Ripple effect
  &::before {
    content: "";
    position: absolute;
    top: 50%;
    left: 50%;
    width: 0;
    height: 0;
    border-radius: 50%;
    background: rgba(255, 255, 255, 0.3);
    transform: translate(-50%, -50%);
    transition:
      width 0.6s,
      height 0.6s;
  }

  &:hover::before {
    width: 300px;
    height: 300px;
  }

  &.parse-Excel {
    @include gradient-button($primary-blue);
    color: white;

    &:hover {
      @include gradient-button($primary-blue, true);
    }
  }

  &.upload-Excel {
    @include gradient-button($primary-green);
    color: white;

    &:hover {
      @include gradient-button($primary-green, true);
    }
  }

  &.add-row-Excel {
    @include gradient-button($primary-blue);
    color: white;

    &:hover {
      @include gradient-button($primary-blue, true);
    }
  }

  &.import-Excel {
    @include gradient-button($primary-yellow);
    color: $text-dark;
    padding: 12px 24px;
    font-size: 15px;

    &:hover {
      @include gradient-button($primary-yellow, true);
    }
  }

  &.loading-Excel {
    pointer-events: none;
    color: transparent;

    &::after {
      content: "";
      position: absolute;
      width: 20px;
      height: 20px;
      top: 50%;
      left: 50%;
      margin: -10px 0 0 -10px;
      border: 3px solid rgba(255, 255, 255, 0.3);
      border-radius: 50%;
      border-top-color: white;
      animation: spin 0.6s linear infinite;
    }

    &::before {
      display: none;
    }
  }
}

// ============= –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä —Ç–∞–±–ª–∏—Ü—ñ =============
.batch-table-container-Excel {
  @include scrollbar;
  overflow: auto;
  border: 2px solid $border-color;
  border-radius: $radius-medium;
  background: white;
  flex: 1;
  min-height: 150px;
  margin-bottom: 16px;
  width: 100%;
  max-width: 100%;
  animation: fadeIn 0.3s ease-out;
}

// ============= –¢–∞–±–ª–∏—Ü—è =============
.batch-table-Excel {
  width: 100%;
  border-collapse: separate;
  border-spacing: 0;
  font-size: 11px;
  border: 2px solid $border-strong;
  border-radius: $radius-small;
  overflow: hidden;
  table-layout: fixed;

  th,
  td {
    padding: 0;
    text-align: center;
    border-right: 1px solid $border-cell;
    border-bottom: 1px solid $border-cell;
    white-space: nowrap;
    background: white;
    vertical-align: middle;
    position: relative;

    &:last-child {
      border-right: none;
    }
  }

  th {
    padding: 5px 4px;
    background: linear-gradient(180deg,
        $bg-header 0%,
        color.adjust($bg-header, $lightness: -3%) 100%);
    font-weight: 700;
    color: $text-dark;
    position: sticky;
    top: 0;
    z-index: 100;
    text-transform: uppercase;
    font-size: 9px;
    letter-spacing: 0.2px;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.08);
    border-bottom: 2px solid $border-strong;
  }

  tbody tr {
    transition: background-color 0.2s;

    &:hover {

      // –í—Å—ñ –∫–æ–ª–æ–Ω–∫–∏ –∫—Ä—ñ–º –æ—Å—Ç–∞–Ω–Ω—å–æ—ó (–ì-—Ç—å / —Å—Ç–∞—Ç—É—Å) - —â–µ —Å–≤—ñ—Ç–ª—ñ—à–∏–π –∑–µ–ª–µ–Ω–∏–π
      td:not(:last-child) {
        background-color: color.adjust($primary-green,
            $lightness: 48%) !important;
      }

      // –Ü–Ω–ø—É—Ç–∏ —Ç–∞–∫–æ–∂ —Å—Ç–∞—é—Ç—å –∑–µ–ª–µ–Ω–∏–º–∏ –ø—Ä–∏ —Ö–æ–≤–µ—Ä—ñ –Ω–∞ —Ä—è–¥–æ–∫ (–∫—Ä—ñ–º –æ—Å—Ç–∞–Ω–Ω—å–æ—ó –∫–æ–ª–æ–Ω–∫–∏)
      td:not(:last-child) .cell-input-Excel,
      td:not(:last-child) .cell-input-combo-Excel {
        background: transparent !important;
      }
    }

    &:last-child td {
      border-bottom: none;
    }

    &:nth-child(even) {
      background-color: rgba(0, 0, 0, 0.015);
    }

    &:has(.cell-input-Excel:focus),
    &:has(.cell-input-combo-Excel:focus) {
      background-color: color.adjust($primary-blue, $lightness: 50%);
      box-shadow: inset 0 0 0 1px color.adjust($primary-blue, $lightness: 30%);
    }
  }

  // Highlight invalid cells
  td.invalid-shop,
  td.invalid-detail {
    background: $bg-warning;
    // box-shadow: inset 0 0 0 2px $warning-orange;
  }

  td.invalid-unit,
  td.invalid-act,
  td.invalid-warehouse,
  td.invalid-qty,
  td.invalid-price {
    background: $bg-error;
    // box-shadow: inset 0 0 0 2px $danger-red;
  }

  td.closed-act {
    background: $bg-warning;
    // box-shadow: inset 0 0 0 2px $warning-orange;
  }

  // –°—Ç–∞—Ç—É—Å –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è - –∫–æ–º—ñ—Ä–∫–∞ –∑ –∫–æ–ª—å–æ—Ä–æ–≤–∏–º —Ç–µ–∫—Å—Ç–æ–º
  td.orderStatus-cell-Excel {
    position: relative;

    .cell-input-Excel {
      background: transparent !important;
      cursor: pointer;
      font-weight: 500;
      text-align: center;
    }
  }

  // –î—ñ—è - –∫–æ–º—ñ—Ä–∫–∞ –∑ –∫–æ–ª—å–æ—Ä–æ–≤–∏–º —Ç–µ–∫—Å—Ç–æ–º
  td.action-cell-Excel {
    position: relative;

    .cell-input-Excel {
      background: transparent !important;
      cursor: pointer;
      font-weight: bold;
      text-align: center;
    }
  }
}

// ============= –Ü–Ω–ø—É—Ç–∏ –≤ —Ç–∞–±–ª–∏—Ü—ñ =============
.cell-input-Excel,
.cell-input-combo-Excel {
  width: 100%;
  height: 100%;
  min-height: 32px;
  padding: 1px 1px;
  border: none;
  background: transparent;
  font-family: inherit;
  font-size: 11px;
  color: $text-dark;
  outline: none;
  transition: $transition-fast;
  box-sizing: border-box;
  text-align: center;
  display: block;

  &:focus {
    background: color.adjust($primary-blue, $lightness: 48%);
    box-shadow: inset 0 0 0 2px $primary-blue;
    position: relative;
    z-index: 1;
  }

  &::placeholder {
    color: $text-placeholder;
    font-style: italic;
    font-size: 12px;
  }

  &:invalid {
    box-shadow: inset 0 0 0 2px color.adjust($danger-red, $lightness: 30%);
  }

  &[type="number"] {
    text-align: center;
    -moz-appearance: textfield;
    appearance: textfield;

    &::-webkit-outer-spin-button,
    &::-webkit-inner-spin-button {
      -webkit-appearance: none;
      appearance: none;
      margin: 0;
    }
  }
}

// –ö–æ–º–±—ñ–Ω–æ–≤–∞–Ω–∏–π —ñ–Ω–ø—É—Ç
.cell-input-combo-Excel {
  cursor: pointer;
  padding-right: 14px !important;

  &::after {
    content: "‚ñº";
    position: absolute;
    right: 10px;
    top: 50%;
    transform: translateY(-50%);
    font-size: 10px;
    color: $primary-blue;
    pointer-events: none;
    transition: $transition;
  }

  &.dropdown-open::after {
    transform: translateY(-50%) rotate(180deg);
    color: color.adjust($primary-blue, $lightness: -15%);
  }

  &:focus {
    background: color.adjust($primary-blue, $lightness: 48%) !important;
    box-shadow: inset 0 0 0 2px $primary-blue !important;
  }
}

// ============= –ê–¥–∞–ø—Ç–∏–≤–Ω—ñ —Å—Ç–∏–ª—ñ –¥–ª—è –ª—ñ–≤–æ–≥–æ –≤–∏—Ä—ñ–≤–Ω—é–≤–∞–Ω–Ω—è =============
.shop-input-Excel,
.detail-input-Excel,
.unit-input-Excel {
  text-align: left;
  min-width: 150px;
  max-width: 100%;
  word-wrap: break-word;
  white-space: normal;
  line-height: 1.4;
}

// ============= –°—Ç–∞—Ç—É—Å –∫–æ–º—ñ—Ä–∫–∏ =============
.status-cell-Excel {
  padding: 2px 4px !important;
  text-align: center;
  min-width: 40px !important;
  max-width: 50px;

  &.success-Excel {
    background: color.adjust($primary-green, $lightness: 40%);
  }

  &.error-Excel {
    background: color.adjust($danger-red, $lightness: 35%);
  }

  &.ready-Excel {
    background: color.adjust($primary-green, $lightness: 42%);
  }
}

.status-text-Excel {
  font-weight: 700;
  font-size: 12px;
  white-space: nowrap;
}

.delete-row-btn-Excel {
  background: transparent;
  border: none;
  cursor: pointer;
  font-size: 14px;
  padding: 1px 2px;
  line-height: 1;
  transition: transform 0.2s;
  flex-shrink: 0;

  &:hover {
    transform: scale(1.3);
  }

  &:active {
    transform: scale(0.9);
  }
}

// ============= –í–∏–ø–∞–¥–∞—é—á–∏–π —Å–ø–∏—Å–æ–∫ =============
.excel-dropdown-list {
  @include scrollbar;
  position: absolute;
  list-style: none;
  margin: 0;
  padding: 8px 0;
  background: linear-gradient(135deg, #ffffff 0%, #f8f9ff 100%);
  border: 2px solid $primary-blue;
  border-radius: $radius-large;
  box-shadow: $shadow-dropdown;
  z-index: 100000;
  overflow-y: auto;
  min-width: 200px;
  animation: dropdownSlideIn 0.2s ease-out;

  &::-webkit-scrollbar {
    width: 8px;
  }

  &::-webkit-scrollbar-track {
    background: rgba(0, 0, 0, 0.05);
    border-radius: $radius-small;
  }

  &::-webkit-scrollbar-thumb {
    background: $primary-blue;
    border-radius: $radius-small;

    &:hover {
      background: color.adjust($primary-blue, $lightness: -10%);
    }
  }
}

.excel-dropdown-item {
  padding: 10px 16px;
  cursor: pointer;
  transition: $transition-fast;
  font-size: 14px;
  color: $text-dark;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  display: flex;
  align-items: center;
  gap: 8px;

  &::before {
    content: "‚ñ∏";
    color: $primary-blue;
    font-size: 12px;
    opacity: 0;
    transform: translateX(-4px);
    transition: $transition-fast;
  }

  &:hover,
  &:focus {
    background: linear-gradient(90deg,
        color.adjust($primary-blue, $lightness: 48%) 0%,
        color.adjust($primary-blue, $lightness: 45%) 100%);
    color: color.adjust($primary-blue, $lightness: -25%);
    font-weight: 600;
    outline: none;
    padding-left: 20px;

    &::before {
      opacity: 1;
      transform: translateX(0);
    }
  }

  &:active {
    background: color.adjust($primary-blue, $lightness: 42%);
    transform: scale(0.98);
  }
}

// ============= –ú–µ–¥—ñ–∞-–∑–∞–ø–∏—Ç–∏ =============
@media (max-width: 1024px) {
  .batch-modal-Excel {
    max-height: 90vh;
    min-width: unset;
  }

  .batch-buttons-Excel {
    //flex-direction: column;
    display: flex;
    justify-content: space-between;
  }

  .batch-btn-Excel {
    width: 100%;
  }

  .batch-table-Excel {
    font-size: 12px;

    th {
      padding: 8px 6px;
      font-size: 11px;
    }

    .cell-input-Excel,
    .cell-input-combo-Excel {
      min-height: 34px;
      padding: 1px 2px;
      font-size: 12px;
    }
  }
}

// ============= –ê–Ω—ñ–º–∞—Ü—ñ—ó =============
@keyframes fadeIn {
  from {
    opacity: 0;
    transform: translateY(-20px);
  }

  to {
    opacity: 1;
    transform: translateY(0);
  }
}

@keyframes scaleIn {
  from {
    opacity: 0;
    transform: scale(0.8);
  }

  to {
    opacity: 1;
    transform: scale(1);
  }
}

@keyframes bounce {

  0%,
  100% {
    transform: translateY(0);
  }

  50% {
    transform: translateY(-10px);
  }
}

@keyframes spin {
  to {
    transform: rotate(360deg);
  }
}

@keyframes dropdownSlideIn {
  from {
    opacity: 0;
    transform: translateY(8px) scale(0.95);
  }

  to {
    opacity: 1;
    transform: translateY(0) scale(1);
  }
}

// ============= –£—Ç–∏–ª—ñ—Ç–Ω–∏–π –∫–ª–∞—Å =============
.hidden-all_other_bases {
  display: none !important;
}

/* –ü—Ä–∏—Ö–æ–≤–∞—Ç–∏ —ñ–∫–æ–Ω–∫—É –Ω–∞—Ç–∏–≤–Ω–æ–≥–æ date-picker'–∞, –∑–±–µ—Ä—ñ–≥—à–∏ –∫–ª—ñ–∫ */
.batch-table-Excel input.cell-input-Excel[type="date"]::-webkit-calendar-picker-indicator {
  opacity: 0;
  /* —ñ–∫–æ–Ω–∫–∞ –Ω–µ–≤–∏–¥–∏–º–∞ */
  pointer-events: auto;
  /* –∑–æ–Ω–∞ –ª–∏—à–∞—î—Ç—å—Å—è –∫–ª—ñ–∫–∞–±–µ–ª—å–Ω–æ—é */
  cursor: pointer;
}

/* –ü—Ä–∏–±—Ä–∞—Ç–∏ –±—É–¥—å-—è–∫—ñ –±–µ–∫–≥—Ä–∞—É–Ω–¥–∏/—ñ–∫–æ–Ω–∫–∏ */
.batch-table-Excel input.cell-input-Excel[type="date"] {
  background-image: none;
  padding-right: 8px;
  /* —Ç—Ä–æ—Ö–∏ –º–µ–Ω—à–µ –º—ñ—Å—Ü—è –ø—ñ–¥ –Ω–µ–≤–∏–¥–∏–º—É —ñ–∫–æ–Ω–∫—É */
}

/* Edge/IE –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–∏ */
.batch-table-Excel input.cell-input-Excel[type="date"]::-ms-clear {
  display: none;
}