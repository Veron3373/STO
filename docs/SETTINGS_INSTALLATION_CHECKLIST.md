# ‚úÖ –ß–µ–∫–ª–∏—Å—Ç –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è Real-Time Settings

## üìã –ü–µ—Ä–µ–¥ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è–º

- [ ] –Ñ –¥–æ—Å—Ç—É–ø –¥–æ Supabase Dashboard
- [ ] –Ñ –ø—Ä–∞–≤–∞ –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä–∞ –≤ –±–∞–∑—ñ –¥–∞–Ω–∏—Ö
- [ ] –Ñ —Ç–µ—Å—Ç–æ–≤—ñ –∞–∫–∞—É–Ω—Ç–∏ —Ä—ñ–∑–Ω–∏—Ö —Ä–æ–ª–µ–π –¥–ª—è —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è
- [ ] –ó—Ä–æ–±–ª–µ–Ω–æ backup –±–∞–∑–∏ –¥–∞–Ω–∏—Ö

## üóÑÔ∏è –ë–∞–∑–∞ –¥–∞–Ω–∏—Ö

### 1. SQL —Å–∫—Ä–∏–ø—Ç
- [ ] –í—ñ–¥–∫—Ä–∏—Ç–∏ Supabase Dashboard ‚Üí SQL Editor
- [ ] –°–∫–æ–ø—ñ—é–≤–∞—Ç–∏ –≤–º—ñ—Å—Ç —Ñ–∞–π–ª—É `supabase/enable_settings_realtime.sql`
- [ ] –í–∏–∫–æ–Ω–∞—Ç–∏ —Å–∫—Ä–∏–ø—Ç
- [ ] –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ —â–æ –Ω–µ–º–∞—î –ø–æ–º–∏–ª–æ–∫

### 2. –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ RLS
```sql
-- –í–∏–∫–æ–Ω–∞—Ç–∏ –≤ SQL Editor:
SELECT tablename, rowsecurity 
FROM pg_tables 
WHERE schemaname = 'public' AND tablename = 'settings';
```
- [ ] `rowsecurity` = `true`

### 3. –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –ø–æ–ª—ñ—Ç–∏–∫
```sql
-- –í–∏–∫–æ–Ω–∞—Ç–∏ –≤ SQL Editor:
SELECT policyname, cmd 
FROM pg_policies
WHERE tablename = 'settings';
```
- [ ] –ü–æ–ª—ñ—Ç–∏–∫–∞ –¥–ª—è SELECT —ñ—Å–Ω—É—î
- [ ] –ü–æ–ª—ñ—Ç–∏–∫–∞ –¥–ª—è UPDATE —ñ—Å–Ω—É—î

### 4. –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ Realtime
```sql
-- –í–∏–∫–æ–Ω–∞—Ç–∏ –≤ SQL Editor:
SELECT * FROM pg_publication_tables 
WHERE pubname = 'supabase_realtime' AND tablename = 'settings';
```
- [ ] –¢–∞–±–ª–∏—Ü—è `settings` –≤ –ø—É–±–ª—ñ–∫–∞—Ü—ñ—ó

## üíª –ö–æ–¥

### 5. –§–∞–π–ª–∏ —Å—Ç–≤–æ—Ä–µ–Ω–æ
- [ ] `src/ts/roboha/zakaz_naraudy/inhi/settings_subscription.ts`
- [ ] `src/ts/roboha/zakaz_naraudy/inhi/settings_realtime_init.ts`
- [ ] `supabase/enable_settings_realtime.sql`

### 6. –§–∞–π–ª–∏ –∑–º—ñ–Ω–µ–Ω–æ
- [ ] `src/ts/main.ts` - –¥–æ–¥–∞–Ω–æ —ñ–º–ø–æ—Ä—Ç `settings_realtime_init`

### 7. –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—è
- [ ] `docs/SETTINGS_REALTIME.md`
- [ ] `docs/SETTINGS_QUICKSTART.md`
- [ ] `docs/SETTINGS_REALTIME_SUMMARY.md`
- [ ] `docs/SETTINGS_FLOW_DIAGRAM.md`
- [ ] `docs/examples/add_new_setting_example.ts`

### 8. –ö–æ–º–ø—ñ–ª—è—Ü—ñ—è
- [ ] –ó–∞–ø—É—Å—Ç–∏—Ç–∏ `npm run build` –∞–±–æ `npm run dev`
- [ ] –ù–µ–º–∞—î TypeScript –ø–æ–º–∏–ª–æ–∫
- [ ] –ù–µ–º–∞—î ESLint –ø–æ–ø–µ—Ä–µ–¥–∂–µ–Ω—å

## üöÄ –î–µ–ø–ª–æ–π

### 9. –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä
- [ ] –í–∏–∫–æ–Ω–∞—Ç–∏ –¥–µ–ø–ª–æ–π –∫–æ–¥—É
- [ ] –ü–µ—Ä–µ–∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ —Å–µ—Ä–≤–µ—Ä (—è–∫—â–æ –ø–æ—Ç—Ä—ñ–±–Ω–æ)
- [ ] –û—á–∏—Å—Ç–∏—Ç–∏ –∫–µ—à –±—Ä–∞—É–∑–µ—Ä–∞ (Ctrl+Shift+R)

## üß™ –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è

### 10. –ë–∞–∑–æ–≤–∞ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∞
- [ ] –í—ñ–¥–∫—Ä–∏—Ç–∏ —Å–∞–π—Ç
- [ ] –í—ñ–¥–∫—Ä–∏—Ç–∏ –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞ (F12)
- [ ] –®—É–∫–∞—Ç–∏ –ª–æ–≥: `üöÄ –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è real-time –ø—ñ–¥–ø–∏—Å–∫–∏ –Ω–∞ settings...`
- [ ] –®—É–∫–∞—Ç–∏ –ª–æ–≥: `‚úÖ –ü—ñ–¥–ø–∏—Å–∫–∞ –Ω–∞ settings –∞–∫—Ç–∏–≤–Ω–∞`

### 11. –¢–µ—Å—Ç –∑ 2 –≤–∫–ª–∞–¥–∫–∞–º–∏ - –ê–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä

**–í–∫–ª–∞–¥–∫–∞ 1:**
- [ ] –ó–∞–ª–æ–≥—ñ–Ω–∏—Ç–∏—Å—å —è–∫ –ê–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä
- [ ] –í—ñ–¥–∫—Ä–∏—Ç–∏ –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è (–∫–Ω–æ–ø–∫–∞ –∑ —à–µ—Å—Ç–µ—Ä–Ω–µ—é)
- [ ] –í–∏–±—Ä–∞—Ç–∏ —Ä–æ–ª—å "–ü—Ä–∏–π–º–∞–ª—å–Ω–∏–∫" (–Ω–∞—Ç–∏—Å–Ω—É—Ç–∏ –Ω–∞ –∫–Ω–æ–ø–∫—É —Ä–æ–ª—ñ)
- [ ] –ó–Ω–∞–π—Ç–∏ —á–µ–∫–±–æ–∫—Å "–ë—É—Ö–≥–∞–ª—Ç–µ—Ä—ñ—è" (id=4)
- [ ] –ó–Ω—è—Ç–∏/–ø–æ—Å—Ç–∞–≤–∏—Ç–∏ —á–µ–∫–±–æ–∫—Å
- [ ] –ù–∞—Ç–∏—Å–Ω—É—Ç–∏ "–û–ö"
- [ ] –ü–æ–±–∞—á–∏—Ç–∏ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è "–ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –∑–±–µ—Ä–µ–∂–µ–Ω–æ!"

**–í–∫–ª–∞–¥–∫–∞ 2:**
- [ ] –ó–∞–ª–æ–≥—ñ–Ω–∏—Ç–∏—Å—å —è–∫ –ü—Ä–∏–π–º–∞–ª—å–Ω–∏–∫ (—ñ–Ω—à–∞ –≤–∫–ª–∞–¥–∫–∞/–±—Ä–∞—É–∑–µ—Ä)
- [ ] –ß–µ–∫–∞—Ç–∏ 1-2 —Å–µ–∫—É–Ω–¥–∏
- [ ] –ü–æ–±–∞—á–∏—Ç–∏ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è "–ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –æ–Ω–æ–≤–ª–µ–Ω–æ –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä–æ–º"
- [ ] –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ —â–æ –∫–Ω–æ–ø–∫–∞ "–ë—É—Ö–≥–∞–ª—Ç–µ—Ä—ñ—è" –∑'—è–≤–∏–ª–∞—Å—å/–∑–Ω–∏–∫–ª–∞
- [ ] –ë–ï–ó –ø–µ—Ä–µ–∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Å—Ç–æ—Ä—ñ–Ω–∫–∏!

### 12. –¢–µ—Å—Ç –∑ 2 –≤–∫–ª–∞–¥–∫–∞–º–∏ - –°–ª—é—Å–∞—Ä

**–í–∫–ª–∞–¥–∫–∞ 1:**
- [ ] –ê–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä –∑–º—ñ–Ω—é—î –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –¥–ª—è –°–ª—é—Å–∞—Ä—è
- [ ] –†–æ–ª—å "–°–ª—é—Å–∞—Ä" ‚Üí —á–µ–∫–±–æ–∫—Å "üìã –ê–∫—Ç –ó–∞—Ä–ø–ª–∞—Ç–∞ üí≤" (id=1)
- [ ] –ó–Ω—è—Ç–∏ —á–µ–∫–±–æ–∫—Å
- [ ] –ù–∞—Ç–∏—Å–Ω—É—Ç–∏ "–û–ö"

**–í–∫–ª–∞–¥–∫–∞ 2:**
- [ ] –ó–∞–ª–æ–≥—ñ–Ω–∏—Ç–∏—Å—å —è–∫ –°–ª—é—Å–∞—Ä
- [ ] –ü–æ–±–∞—á–∏—Ç–∏ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –ø—Ä–æ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è
- [ ] –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –∑–º—ñ–Ω–∏ –≤ UI

### 13. –¢–µ—Å—Ç —Ñ—ñ–ª—å—Ç—Ä–∞—Ü—ñ—ó

**–í–∫–ª–∞–¥–∫–∞ 1:**
- [ ] –ê–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä –∑–º—ñ–Ω—é—î "–ü—Ä–∏–π–º–∞–ª—å–Ω–∏–∫" ‚Üí setting_id=4

**–í–∫–ª–∞–¥–∫–∞ 2 (–ü—Ä–∏–π–º–∞–ª—å–Ω–∏–∫):**
- [ ] –û—Ç—Ä–∏–º—É—î –æ–Ω–æ–≤–ª–µ–Ω–Ω—è ‚úÖ

**–í–∫–ª–∞–¥–∫–∞ 3 (–°–ª—é—Å–∞—Ä):**
- [ ] –ù–ï –æ—Ç—Ä–∏–º—É—î –æ–Ω–æ–≤–ª–µ–Ω–Ω—è ‚ùå
- [ ] –í –∫–æ–Ω—Å–æ–ª—ñ: "‚ÑπÔ∏è –ó–º—ñ–Ω–∞ –Ω–µ —Å—Ç–æ—Å—É—î—Ç—å—Å—è —Ä–æ–ª—ñ –°–ª—é—Å–∞—Ä"

### 14. –ö–æ–Ω—Å–æ–ª—å–Ω—ñ –ª–æ–≥–∏

–ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –≤ –∫–æ–Ω—Å–æ–ª—ñ –±—Ä–∞—É–∑–µ—Ä–∞:
- [ ] `üîå –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è –ø—ñ–¥–ø–∏—Å–∫–∏ –Ω–∞ –∑–º—ñ–Ω–∏ –≤ settings...`
- [ ] `‚úÖ –ü—ñ–¥–ø–∏—Å–∫–∞ –Ω–∞ settings –∞–∫—Ç–∏–≤–Ω–∞`
- [ ] (–ü—Ä–∏ –∑–º—ñ–Ω—ñ) `üì° Settings change detected:`
- [ ] (–ü—Ä–∏ –∑–º—ñ–Ω—ñ) `üîç –ó–º—ñ–Ω–∞ –≤ setting_id=X, –∫–æ–ª–æ–Ω–∫–∞="..."`
- [ ] (–ü—Ä–∏ –∑–º—ñ–Ω—ñ) `‚úÖ Settings cache –æ–Ω–æ–≤–ª–µ–Ω–æ`
- [ ] (–ü—Ä–∏ –∑–º—ñ–Ω—ñ) `üîÑ UI –æ–Ω–æ–≤–ª–µ–Ω–æ –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–æ –¥–æ –Ω–æ–≤–∏—Ö –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω—å`

### 15. –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –ø–æ–º–∏–ª–æ–∫
- [ ] –ù–µ–º–∞—î —á–µ—Ä–≤–æ–Ω–∏—Ö –ø–æ–º–∏–ª–æ–∫ –≤ –∫–æ–Ω—Å–æ–ª—ñ
- [ ] –ù–µ–º–∞—î –ø–æ–º–∏–ª–æ–∫ –≤ Network tab
- [ ] WebSocket –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –∞–∫—Ç–∏–≤–Ω–µ (–≤ Network ‚Üí WS)

## üêõ –ù–∞–ª–∞–≥–æ–¥–∂–µ–Ω–Ω—è

### 16. –Ø–∫—â–æ –ø—ñ–¥–ø–∏—Å–∫–∞ –Ω–µ –ø—Ä–∞—Ü—é—î:

**–ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ 1: WebSocket**
- [ ] Network tab ‚Üí WS ‚Üí –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ —â–æ —î –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –¥–æ Supabase
- [ ] –°—Ç–∞—Ç—É—Å –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è: "connected"

**–ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ 2: –ê–≤—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—è**
```typescript
// –í –∫–æ–Ω—Å–æ–ª—ñ:
const { data } = await supabase.auth.getSession();
console.log('Authenticated:', !!data.session);
```
- [ ] Authenticated: `true`

**–ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ 3: –ü—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø—É**
```sql
-- –í SQL Editor:
SELECT * FROM users WHERE user_id = auth.uid();
```
- [ ] –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á —ñ—Å–Ω—É—î
- [ ] –ú–∞—î –ø—Ä–∞–≤–∏–ª—å–Ω—É —Ä–æ–ª—å

**–ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ 4: –ü—ñ–¥–ø–∏—Å–∫–∞ –∞–∫—Ç–∏–≤–Ω–∞**
```typescript
// –í –∫–æ–Ω—Å–æ–ª—ñ:
import { isSettingsSubscriptionActive } from './settings_subscription';
console.log(isSettingsSubscriptionActive());
```
- [ ] –†–µ–∑—É–ª—å—Ç–∞—Ç: `true`

### 17. –Ø–∫—â–æ UI –Ω–µ –æ–Ω–æ–≤–ª—é—î—Ç—å—Å—è:

- [ ] –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ —â–æ —Ñ—É–Ω–∫—Ü—ñ—ó `updateXXXVisibility()` –∑–Ω–∞—Ö–æ–¥—è—Ç—å –µ–ª–µ–º–µ–Ω—Ç–∏
- [ ] –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ —Å–µ–ª–µ–∫—Ç–æ—Ä–∏ –≤ DOM
- [ ] –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ —â–æ `globalCache.settings` –æ–Ω–æ–≤–ª—é—î—Ç—å—Å—è
- [ ] –°–ø—Ä–æ–±—É–≤–∞—Ç–∏ —Ä—É—á–Ω–∏–π –≤–∏–∫–ª–∏–∫: `updateUIBasedOnSettings()`

## üìä –ú–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥

### 18. –õ–æ–≥–∏ —Å–µ—Ä–≤–µ—Ä–∞
- [ ] –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ Supabase Logs ‚Üí Database
- [ ] –®—É–∫–∞—Ç–∏ NOTICE –∑ —Ñ—É–Ω–∫—Ü—ñ—ó `log_settings_changes()`

### 19. –ê–Ω–∞–ª—ñ—Ç–∏–∫–∞
- [ ] –ó–∞–ø–∏—Å—É–≤–∞—Ç–∏ –∫—ñ–ª—å–∫—ñ—Å—Ç—å –æ–Ω–æ–≤–ª–µ–Ω—å –Ω–∞ –¥–µ–Ω—å
- [ ] –ú–æ–Ω—ñ—Ç–æ—Ä–∏—Ç–∏ –∑–∞—Ç—Ä–∏–º–∫—É –æ–Ω–æ–≤–ª–µ–Ω—å
- [ ] –ü–µ—Ä–µ–≤—ñ—Ä—è—Ç–∏ –ø–æ–º–∏–ª–∫–∏ –≤ Sentry/Logger

## ‚úÖ –§—ñ–Ω–∞–ª—å–Ω–∞ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∞

### 20. –í—Å–µ —Ä–æ–ª—ñ

–ü—Ä–æ—Ç–µ—Å—Ç—É–≤–∞—Ç–∏ –¥–ª—è –∫–æ–∂–Ω–æ—ó —Ä–æ–ª—ñ:
- [ ] –ê–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä - –±–∞—á–∏—Ç—å –≤—Å—ñ –∑–º—ñ–Ω–∏
- [ ] –ü—Ä–∏–π–º–∞–ª—å–Ω–∏–∫ - –±–∞—á–∏—Ç—å —Å–≤–æ—ó –∑–º—ñ–Ω–∏
- [ ] –°–ª—é—Å–∞—Ä - –±–∞—á–∏—Ç—å —Å–≤–æ—ó –∑–º—ñ–Ω–∏
- [ ] –ó–∞–ø—á–∞—Å—Ç–∏—Å—Ç - –±–∞—á–∏—Ç—å —Å–≤–æ—ó –∑–º—ñ–Ω–∏
- [ ] –°–∫–ª–∞–¥–æ–≤—â–∏–∫ - –±–∞—á–∏—Ç—å —Å–≤–æ—ó –∑–º—ñ–Ω–∏

### 21. –†—ñ–∑–Ω—ñ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è

- [ ] –ü–Ü–ë/–ú–∞–≥–∞–∑–∏–Ω (setting_id=1)
- [ ] –ö–∞—Ç–∞–ª–æ–≥ (setting_id=2)
- [ ] –ó–∞—Ä–ø–ª–∞—Ç–∞ (setting_id=3)
- [ ] SMS (setting_id=5)
- [ ] –ë—É—Ö–≥–∞–ª—Ç–µ—Ä—ñ—è (setting_id=4)

### 22. –ö—Ä–∞–π–Ω—ñ –≤–∏–ø–∞–¥–∫–∏

- [ ] –ó–º—ñ–Ω–∞ –¥–µ–∫—ñ–ª—å–∫–æ—Ö –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω—å –æ–¥–Ω–æ—á–∞—Å–Ω–æ
- [ ] –®–≤–∏–¥–∫—ñ –ø–æ—Å–ª—ñ–¥–æ–≤–Ω—ñ –∑–º—ñ–Ω–∏
- [ ] –í—Ç—Ä–∞—Ç–∞ –∑'—î–¥–Ω–∞–Ω–Ω—è —Ç–∞ –ø–æ–≤—Ç–æ—Ä–Ω–µ –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è
- [ ] –ó–∞–∫—Ä–∏—Ç—Ç—è –≤–∫–ª–∞–¥–∫–∏ —Ç–∞ –ø–æ–≤—Ç–æ—Ä–Ω–µ –≤—ñ–¥–∫—Ä–∏—Ç—Ç—è

## üéâ –ì–æ—Ç–æ–≤–æ!

–Ø–∫—â–æ –≤—Å—ñ —á–µ–∫–±–æ–∫—Å–∏ ‚úÖ - —Å–∏—Å—Ç–µ–º–∞ –ø—Ä–∞—Ü—é—î –ø—Ä–∞–≤–∏–ª—å–Ω–æ!

---

**–î–∞—Ç–∞ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏:** _________________  
**–í–∏–∫–æ–Ω–∞–≤:** _________________  
**–°—Ç–∞—Ç—É—Å:** [ ] ‚úÖ –£—Å–ø—ñ—à–Ω–æ  [ ] ‚ö†Ô∏è –ó –ø–æ–ø–µ—Ä–µ–¥–∂–µ–Ω–Ω—è–º–∏  [ ] ‚ùå –ü—Ä–æ–≤–∞–ª–µ–Ω–æ  

**–ü—Ä–∏–º—ñ—Ç–∫–∏:**
_______________________________________________________________
_______________________________________________________________
_______________________________________________________________
