# –í–∏–ø—Ä–∞–≤–ª–µ–Ω–Ω—è –ª–æ–≥—É–≤–∞–Ω–Ω—è –∑–º—ñ–Ω –¥–ª—è –≤—Å—ñ—Ö —Ä–æ–ª–µ–π

## –ü—Ä–æ–±–ª–µ–º–∞
–ö–æ–ª–∏ –°–ª—é—Å–∞—Ä, –ü—Ä–∏–π–º–∞–ª—å–Ω–∏–∫, –°–∫–ª–∞–¥–æ–≤—â–∏–∫ –∞–±–æ –ó–∞–ø—á–∞—Å—Ç–∏—Å—Ç –¥–æ–¥–∞–≤–∞–ª–∏/–≤–∏–¥–∞–ª—è–ª–∏ —Ä—è–¥–∫–∏ –≤ –∞–∫—Ç—ñ, —Ü—ñ –∑–º—ñ–Ω–∏ –Ω–µ –∑–∞–ø–∏—Å—É–≤–∞–ª–∏—Å—è –≤ —Ç–∞–±–ª–∏—Ü—é `act_changes_notifications`. –¶–µ –ø—Ä–∏–∑–≤–æ–¥–∏–ª–æ –¥–æ —Ç–æ–≥–æ, —â–æ:
- –ê–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä –Ω–µ –±–∞—á–∏–≤ –≤—Å–ø–ª–∞–≤–∞—é—á—ñ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –ø—Ä–æ –∑–º—ñ–Ω–∏
- –ê–∫—Ç–∏ –Ω–µ –ø—ñ–¥—Å–≤—ñ—á—É–≤–∞–ª–∏—Å—è –≤ —Ç–∞–±–ª–∏—Ü—ñ
- "–°–≤—ñ—Ç–ª–æ—Ñ–æ—Ä" –≤ –∞–∫—Ç—ñ –Ω–µ –ø—Ä–∞—Ü—é–≤–∞–≤

## –ü—Ä–∏—á–∏–Ω–∞
–§—É–Ω–∫—Ü—ñ—è `logActChanges()` –≤–∏–∫–ª–∏–∫–∞–ª–∞—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ, –∞–ª–µ:
1. **–í—ñ–¥—Å—É—Ç–Ω—î –ø–æ–ª–µ `slyusarSum` –≤ —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ñ `ActItem`** - –ø—Ä–∏ –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü—ñ—ó `ActItem` –≤ `ParsedItem` –∑–∞—Ä–ø–ª–∞—Ç–∞ —Å–ª—é—Å–∞—Ä—è –∑–∞–≤–∂–¥–∏ –±—É–ª–∞ 0
2. **–ù–µ–¥–æ—Å—Ç–∞—Ç–Ω—å–æ –ª–æ–≥—É–≤–∞–Ω–Ω—è** - –Ω–µ –±—É–ª–æ –≤–∏–¥–Ω–æ —á–∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –ø–æ—Ä—ñ–≤–Ω—é—é—Ç—å—Å—è –ø–æ—á–∞—Ç–∫–æ–≤—ñ —Ç–∞ –ø–æ—Ç–æ—á–Ω—ñ –µ–ª–µ–º–µ–Ω—Ç–∏

## –†—ñ—à–µ–Ω–Ω—è

### 1. –î–æ–¥–∞–Ω–æ –ø–æ–ª–µ `slyusarSum` –≤ —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å `ActItem` (`globalCache.ts`)
```typescript
export interface ActItem {
  type: "detail" | "work";
  name: string;
  catalog: string;
  quantity: number;
  price: number;
  sum: number;
  person_or_store: string;
  sclad_id?: number | null;
  slyusar_id?: number | null;
  slyusarSum?: number; // ‚úÖ –î–æ–¥–∞–Ω–æ –¥–ª—è –∑–∞—Ä–ø–ª–∞—Ç–∏ —Å–ª—é—Å–∞—Ä—è
}
```

### 2. –û–Ω–æ–≤–ª–µ–Ω–æ —Ñ—É–Ω–∫—Ü—ñ—é `convertActItemsToParsedItems` (`zberechennya_zmin_y_danux_aktu.ts`)
**–ë—É–ª–æ:**
```typescript
slyusarSum: 0, // ActItem –Ω–µ –º–∞—î —Ü—å–æ–≥–æ –ø–æ–ª—è, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ 0
```

**–°—Ç–∞–ª–æ:**
```typescript
slyusarSum: item.slyusarSum || 0, // ‚úÖ –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ slyusarSum –∑ ActItem
```

### 3. –î–æ–¥–∞–Ω–æ –¥–µ—Ç–∞–ª—å–Ω–µ –ª–æ–≥—É–≤–∞–Ω–Ω—è –≤ `compareActChanges`
–¢–µ–ø–µ—Ä —Ñ—É–Ω–∫—Ü—ñ—è –≤–∏–≤–æ–¥–∏—Ç—å –≤ –∫–æ–Ω—Å–æ–ª—å:
- –ü–æ—á–∞—Ç–∫–æ–≤—ñ –µ–ª–µ–º–µ–Ω—Ç–∏ (–∑ `globalCache.initialActItems`)
- –ü–æ—Ç–æ—á–Ω—ñ –µ–ª–µ–º–µ–Ω—Ç–∏ (–∑ DOM)
- –î–æ–¥–∞–Ω—ñ –ø–æ–∑–∏—Ü—ñ—ó (–∑ –∫–ª—é—á–µ–º `type:name`)
- –í–∏–¥–∞–ª–µ–Ω—ñ –ø–æ–∑–∏—Ü—ñ—ó (–∑ –∫–ª—é—á–µ–º `type:name`)
- –ó–∞–≥–∞–ª—å–Ω—É –∫—ñ–ª—å–∫—ñ—Å—Ç—å –∑–º—ñ–Ω

**–ü—Ä–∏–∫–ª–∞–¥ –ª–æ–≥—É–≤–∞–Ω–Ω—è:**
```
üîç [compareActChanges] –ü–æ—á–∞—Ç–∫–æ–≤—ñ –µ–ª–µ–º–µ–Ω—Ç–∏ (2): [...]
üîç [compareActChanges] –ü–æ—Ç–æ—á–Ω—ñ –µ–ª–µ–º–µ–Ω—Ç–∏ (3): [...]
‚ûï [compareActChanges] –î–æ–¥–∞–Ω–æ: detail:–ù–æ–≤–∞ –¥–µ—Ç–∞–ª—å {...}
üìä [compareActChanges] –†–µ–∑—É–ª—å—Ç–∞—Ç: –¥–æ–¥–∞–Ω–æ 1, –≤–∏–¥–∞–ª–µ–Ω–æ 0
```

## –Ø–∫ —Ü–µ –ø—Ä–∞—Ü—é—î

### –°—Ü–µ–Ω–∞—Ä—ñ–π: –°–ª—é—Å–∞—Ä –¥–æ–¥–∞—î –Ω–æ–≤–∏–π —Ä—è–¥–æ–∫
1. **–°–ª—é—Å–∞—Ä –≤—ñ–¥–∫—Ä–∏–≤–∞—î –∞–∫—Ç:**
   - `globalCache.initialActItems` –∑–±–µ—Ä—ñ–≥–∞—î –ø–æ—á–∞—Ç–∫–æ–≤–∏–π —Å—Ç–∞–Ω (2 –µ–ª–µ–º–µ–Ω—Ç–∏)

2. **–°–ª—é—Å–∞—Ä –¥–æ–¥–∞—î –Ω–æ–≤–∏–π —Ä—è–¥–æ–∫:**
   - –ù–∞–π–º–µ–Ω—É–≤–∞–Ω–Ω—è: "–ù–æ–≤–∞ –¥–µ—Ç–∞–ª—å"
   - –ö—ñ–ª—å–∫—ñ—Å—Ç—å: 5
   - –ù–∞—Ç–∏—Å–∫–∞—î "–ó–±–µ—Ä–µ–≥—Ç–∏ –∑–º—ñ–Ω–∏"

3. **–ü—Ä–∏ –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—ñ:**
   - `parseTableRows()` –∑–±–∏—Ä–∞—î –¥–∞–Ω—ñ –∑ DOM (3 –µ–ª–µ–º–µ–Ω—Ç–∏)
   - `compareActChanges()` –ø–æ—Ä—ñ–≤–Ω—é—î:
     - `initialItems`: 2 –µ–ª–µ–º–µ–Ω—Ç–∏
     - `currentItems`: 3 –µ–ª–µ–º–µ–Ω—Ç–∏
   - –ó–Ω–∞—Ö–æ–¥–∏—Ç—å –¥–æ–¥–∞–Ω—É –ø–æ–∑–∏—Ü—ñ—é: `detail:–ù–æ–≤–∞ –¥–µ—Ç–∞–ª—å`
   - –õ–æ–≥—É—î –≤ –∫–æ–Ω—Å–æ–ª—å: `‚ûï [compareActChanges] –î–æ–¥–∞–Ω–æ: detail:–ù–æ–≤–∞ –¥–µ—Ç–∞–ª—å`

4. **`logActChanges()` –∑–∞–ø–∏—Å—É—î –≤ –ë–î:**
   ```sql
   INSERT INTO act_changes_notifications (
     act_id, item_name, cina, kilkist, zarplata,
     dodav_vudaluv, changed_by_surname, delit, data, pib, auto
   ) VALUES (
     123, '–ù–æ–≤–∞ –¥–µ—Ç–∞–ª—å', 0, 5, 0,
     true, '–Ü–≤–∞–Ω–æ–≤ –Ü–≤–∞–Ω', false, '2025-12-22T19:35:22Z', '–ü–µ—Ç—Ä–µ–Ω–∫–æ –ü.–ü.', 'Toyota Camry 2015'
   )
   ```

5. **–ê–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä –≤—ñ–¥–∫—Ä–∏–≤–∞—î –∞–∫—Ç:**
   - –ë–∞—á–∏—Ç—å –≤—Å–ø–ª–∞–≤–∞—é—á–µ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è: "–Ü–≤–∞–Ω–æ–≤ –Ü–≤–∞–Ω –¥–æ–¥–∞–≤ –ù–æ–≤–∞ –¥–µ—Ç–∞–ª—å"
   - –†—è–¥–æ–∫ "–ù–æ–≤–∞ –¥–µ—Ç–∞–ª—å" –ø—ñ–¥—Å–≤—ñ—á—É—î—Ç—å—Å—è –∑–µ–ª–µ–Ω–∏–º
   - "–°–≤—ñ—Ç–ª–æ—Ñ–æ—Ä" –ø–æ–∫–∞–∑—É—î –∑–º—ñ–Ω–∏

## –ü–µ—Ä–µ–≤–∞–≥–∏
‚úÖ **–ü–æ–≤–Ω–µ –ª–æ–≥—É–≤–∞–Ω–Ω—è:** –í—Å—ñ –∑–º—ñ–Ω–∏ (–¥–æ–¥–∞–≤–∞–Ω–Ω—è/–≤–∏–¥–∞–ª–µ–Ω–Ω—è) –∑–∞–ø–∏—Å—É—é—Ç—å—Å—è –≤ –ë–î  
‚úÖ **–î–µ—Ç–∞–ª—å–Ω–∞ –¥—ñ–∞–≥–Ω–æ—Å—Ç–∏–∫–∞:** –õ–æ–≥—É–≤–∞–Ω–Ω—è –≤ –∫–æ–Ω—Å–æ–ª—ñ –¥–æ–ø–æ–º–∞–≥–∞—î –≤—ñ–¥—Å—Ç–µ–∂–∏—Ç–∏ –ø—Ä–æ–±–ª–µ–º–∏  
‚úÖ **–ü—Ä–∞–≤–∏–ª—å–Ω—ñ –¥–∞–Ω—ñ:** –ó–∞—Ä–ø–ª–∞—Ç–∞ —Å–ª—é—Å–∞—Ä—è –∑–±–µ—Ä—ñ–≥–∞—î—Ç—å—Å—è –∫–æ—Ä–µ–∫—Ç–Ω–æ  
‚úÖ **–ü—Ä–∞—Ü—é—î –¥–ª—è –≤—Å—ñ—Ö —Ä–æ–ª–µ–π:** –°–ª—é—Å–∞—Ä, –ü—Ä–∏–π–º–∞–ª—å–Ω–∏–∫, –°–∫–ª–∞–¥–æ–≤—â–∏–∫, –ó–∞–ø—á–∞—Å—Ç–∏—Å—Ç

## –ó–º—ñ–Ω–µ–Ω—ñ —Ñ–∞–π–ª–∏
1. `src/ts/roboha/zakaz_naraudy/globalCache.ts`
   - –î–æ–¥–∞–Ω–æ –ø–æ–ª–µ `slyusarSum` –≤ —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å `ActItem`

2. `src/ts/roboha/zakaz_naraudy/inhi/zberechennya_zmin_y_danux_aktu.ts`
   - –û–Ω–æ–≤–ª–µ–Ω–æ `convertActItemsToParsedItems()` –¥–ª—è –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è `slyusarSum`
   - –î–æ–¥–∞–Ω–æ –¥–µ—Ç–∞–ª—å–Ω–µ –ª–æ–≥—É–≤–∞–Ω–Ω—è –≤ `compareActChanges()`

## –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è
–î–ª—è –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ —Ä–æ–±–æ—Ç–∏:
1. –í—ñ–¥–∫—Ä–∏–π—Ç–µ –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞ (F12)
2. –ó–∞–π–¥—ñ—Ç—å —è–∫ –°–ª—é—Å–∞—Ä
3. –í—ñ–¥–∫—Ä–∏–π—Ç–µ –±—É–¥—å-—è–∫–∏–π –∞–∫—Ç
4. –î–æ–¥–∞–π—Ç–µ –Ω–æ–≤–∏–π —Ä—è–¥–æ–∫
5. –ó–±–µ—Ä–µ–∂—ñ—Ç—å –∑–º—ñ–Ω–∏
6. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –∫–æ–Ω—Å–æ–ª—å - –ø–æ–≤–∏–Ω–Ω—ñ –±—É—Ç–∏ –ª–æ–≥–∏:
   ```
   üîç [compareActChanges] –ü–æ—á–∞—Ç–∫–æ–≤—ñ –µ–ª–µ–º–µ–Ω—Ç–∏ (...)
   ‚ûï [compareActChanges] –î–æ–¥–∞–Ω–æ: ...
   üìù [logActChanges] –ü—ñ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω–æ ... –∑–∞–ø–∏—Å—ñ–≤ –¥–ª—è –≤—Å—Ç–∞–≤–∫–∏
   ‚úÖ –ó–∞–ø–∏—Å–∞–Ω–æ ... –∑–º—ñ–Ω –≤ –ë–î
   ```
7. –ó–∞–π–¥—ñ—Ç—å —è–∫ –ê–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä
8. –í—ñ–¥–∫—Ä–∏–π—Ç–µ —Ç–æ–π —Å–∞–º–∏–π –∞–∫—Ç
9. –ü–æ–≤–∏–Ω–Ω—ñ –ø–æ–±–∞—á–∏—Ç–∏:
   - –í—Å–ø–ª–∞–≤–∞—é—á–µ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –ø—Ä–æ –∑–º—ñ–Ω–∏
   - –ü—ñ–¥—Å–≤—ñ—á—É–≤–∞–Ω–Ω—è –¥–æ–¥–∞–Ω–æ–≥–æ —Ä—è–¥–∫–∞ (–∑–µ–ª–µ–Ω–∏–π)
   - "–°–≤—ñ—Ç–ª–æ—Ñ–æ—Ä" –∑ –ø–æ–∑–Ω–∞—á–∫–æ—é –∑–º—ñ–Ω
